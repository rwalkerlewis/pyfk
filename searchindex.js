Search.setIndex({"docnames": ["autoapi/index", "autoapi/pyfk/config/config/index", "autoapi/pyfk/config/index", "autoapi/pyfk/config/radiats/index", "autoapi/pyfk/gf/cuda/index", "autoapi/pyfk/gf/cuda/utils/index", "autoapi/pyfk/gf/cuda/waveform_integration_cuda/index", "autoapi/pyfk/gf/gf/index", "autoapi/pyfk/gf/index", "autoapi/pyfk/index", "autoapi/pyfk/setting/index", "autoapi/pyfk/sync/index", "autoapi/pyfk/sync/sync/index", "autoapi/pyfk/taup/index", "autoapi/pyfk/tests/config/index", "autoapi/pyfk/tests/config/test_config/index", "autoapi/pyfk/tests/gf/index", "autoapi/pyfk/tests/gf/test_gf/index", "autoapi/pyfk/tests/gf/test_gf_mpi/index", "autoapi/pyfk/tests/index", "autoapi/pyfk/tests/sync/index", "autoapi/pyfk/tests/sync/test_sync/index", "autoapi/pyfk/tests/taup/index", "autoapi/pyfk/tests/taup/test_taup/index", "autoapi/pyfk/utils/error_message/index", "autoapi/pyfk/utils/index", "benchmark/benchmark", "gallery/gallery", "index", "introduction/install", "introduction/tutorial", "parallel/parallel"], "filenames": ["autoapi/index.rst", "autoapi/pyfk/config/config/index.rst", "autoapi/pyfk/config/index.rst", "autoapi/pyfk/config/radiats/index.rst", "autoapi/pyfk/gf/cuda/index.rst", "autoapi/pyfk/gf/cuda/utils/index.rst", "autoapi/pyfk/gf/cuda/waveform_integration_cuda/index.rst", "autoapi/pyfk/gf/gf/index.rst", "autoapi/pyfk/gf/index.rst", "autoapi/pyfk/index.rst", "autoapi/pyfk/setting/index.rst", "autoapi/pyfk/sync/index.rst", "autoapi/pyfk/sync/sync/index.rst", "autoapi/pyfk/taup/index.rst", "autoapi/pyfk/tests/config/index.rst", "autoapi/pyfk/tests/config/test_config/index.rst", "autoapi/pyfk/tests/gf/index.rst", "autoapi/pyfk/tests/gf/test_gf/index.rst", "autoapi/pyfk/tests/gf/test_gf_mpi/index.rst", "autoapi/pyfk/tests/index.rst", "autoapi/pyfk/tests/sync/index.rst", "autoapi/pyfk/tests/sync/test_sync/index.rst", "autoapi/pyfk/tests/taup/index.rst", "autoapi/pyfk/tests/taup/test_taup/index.rst", "autoapi/pyfk/utils/error_message/index.rst", "autoapi/pyfk/utils/index.rst", "benchmark/benchmark.rst", "gallery/gallery.rst", "index.rst", "introduction/install.rst", "introduction/tutorial.rst", "parallel/parallel.rst"], "titles": ["API Reference", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.config.config</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.config</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.config.radiats</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.gf.cuda</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.gf.cuda.utils</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.gf.cuda.waveform_integration_cuda</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.gf.gf</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.gf</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.setting</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.sync</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.sync.sync</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.taup</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.config</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.config.test_config</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.gf</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.gf.test_gf</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.gf.test_gf_mpi</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.sync</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.sync.test_sync</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.taup</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.tests.taup.test_taup</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.utils.error_message</span></code>", "<code class=\"xref py py-mod docutils literal notranslate\"><span class=\"pre\">pyfk.utils</span></code>", "Benchmark", "Gallery", "PyFK", "Installing", "Tutorial", "Parallelization"], "terms": {"thi": [0, 1, 9, 28, 29, 30, 31], "page": 0, "contain": [0, 30], "auto": 0, "gener": [0, 1, 9, 12, 31], "document": [0, 28, 29, 30, 31], "1": [0, 1, 7, 9, 12, 28, 29, 30, 31], "pyfk": [0, 30, 31], "config": [0, 7, 9, 12, 19, 30, 31], "radiat": [0, 1, 2, 9, 12], "gf": [0, 9, 12, 19, 30, 31], "cuda": [0, 1, 8, 9, 28, 29, 30, 31], "util": [0, 4, 8, 9], "waveform_integration_cuda": [0, 4, 8, 9], "sync": [0, 9, 19, 30], "taup": [0, 9, 19, 30, 31], "test": [0, 9, 30, 31], "test_config": [0, 9, 14, 19], "test_gf": [0, 9, 16, 19], "test_gf_mpi": [0, 9, 16, 19], "test_sync": [0, 9, 19, 20, 30], "test_taup": [0, 9, 19, 22, 30, 31], "error_messag": [0, 9, 25], "set": [0, 1, 9, 12, 29, 30, 31], "creat": [0, 30], "sphinx": 0, "autoapi": 0, "model": [1, 7, 9, 12, 28, 30, 31], "none": [1, 7, 9, 12, 30], "sourc": [1, 3, 5, 6, 7, 9, 10, 12, 15, 17, 18, 21, 23, 24, 28, 29, 30, 31], "receiver_dist": [1, 6, 7, 9, 30, 31], "planet_radiu": [1, 9], "6371": [1, 9, 10], "0": [1, 3, 9, 10, 12, 29, 30, 31], "degre": [1, 9, 12, 30], "fals": [1, 9, 30], "taper": [1, 6, 7, 9, 30], "3": [1, 9, 29, 30], "filter": [1, 7, 9, 30], "npt": [1, 7, 9, 30, 31], "256": [1, 9], "dt": [1, 9, 30, 31], "dk": [1, 6, 7, 9, 30], "smth": [1, 9, 30], "pmin": [1, 6, 7, 9, 30], "pmax": [1, 6, 7, 9, 30], "kmax": [1, 9, 30], "15": [1, 9, 30, 31], "rdep": [1, 9, 30], "updn": [1, 5, 6, 9, 30], "all": [1, 9, 28, 29, 30, 31], "samples_before_first_arriv": [1, 9, 30], "50": [1, 9, 30], "suppression_sigma": [1, 9, 30], "2": [1, 7, 9, 10, 29, 30], "base": [1, 9, 12, 15, 17, 18, 21, 23, 24, 28, 30, 31], "object": [1, 9, 15, 17, 18, 21, 23, 30], "The": [1, 9, 28, 29, 30, 31], "configur": [1, 7, 9, 12], "us": [1, 7, 9, 12, 28, 29, 30, 31], "green": [1, 7, 9, 12, 28, 31], "": [1, 7, 9, 12, 28, 29, 31], "function": [1, 28, 31], "synthet": [1, 9, 28, 31], "waveform": [1, 9, 28, 29, 31], "paramet": [1, 3, 5, 6, 7, 9, 12], "option": [1, 7, 9, 12, 30], "seismodel": [1, 7, 9, 30, 31], "earth": [1, 7, 9, 28, 30], "calcul": [1, 3, 7, 9, 12, 28, 31], "default": [1, 7, 9, 12, 30], "sourcemodel": [1, 9, 12, 30, 31], "union": [1, 7, 9, 12], "list": [1, 7, 9, 12, 28, 30], "np": [1, 3, 7, 9, 29, 30, 31], "ndarrai": [1, 3, 5, 6, 7, 9], "receiv": [1, 7, 9, 30], "distanc": [1, 9, 12, 30], "km": [1, 9, 30], "bool": [1, 6, 7, 9], "instead": [1, 9, 29, 30, 31], "float": [1, 3, 6, 7, 9, 10, 12, 30], "radiu": [1, 9], "planet": [1, 9], "appli": [1, 9, 31], "low": [1, 9], "pass": [1, 9, 30, 31], "cosin": [1, 9], "fc": [1, 9], "f_niquest": [1, 9], "tupl": [1, 9], "high": [1, 9], "transit": [1, 9], "zone": [1, 9], "between": [1, 9, 30], "freq": [1, 9], "f1": [1, 9], "f2": [1, 9], "hz": [1, 9, 30], "int": [1, 5, 6, 7, 9, 12], "number": [1, 7, 9, 12, 28, 30], "point": [1, 7, 9, 30], "sampl": [1, 7, 9, 30], "interv": [1, 7, 9, 30], "second": [1, 9, 30, 31], "non": [1, 9], "dimension": [1, 9], "wavenumb": [1, 7, 9, 28, 31], "make": [1, 9, 31], "final": [1, 9], "min": [1, 7, 9, 28], "slow": [1, 7, 9], "term": [1, 9, 28], "vs_at_the_sourc": [1, 9], "max": [1, 7, 9], "zero": [1, 9, 29], "frequenc": [1, 7, 9, 28, 30, 31], "h": [1, 9, 28, 29], "depth": [1, 9, 30], "str": [1, 7, 9], "up": [1, 7, 9, 12, 28, 30], "go": [1, 9, 31], "wave": [1, 7, 9, 30], "onli": [1, 9, 29, 30, 31], "down": [1, 9], "both": [1, 9], "befor": [1, 9, 29, 30, 31], "first": [1, 7, 9, 28, 30, 31], "arriv": [1, 7, 9, 30], "suppress": [1, 9], "factor": [1, 9], "numer": [1, 7, 9, 30], "nois": [1, 7, 9, 30], "whether": [1, 9, 30], "mode": [1, 9, 28], "pyfk_use_cuda": [1, 9, 29, 31], "flag": [1, 9, 30], "ignor": [1, 9], "alwai": [1, 9], "rais": [1, 9, 12], "pyfkerror": [1, 9, 12, 24], "must": [1, 9, 12], "provid": [1, 3, 9, 12, 28, 29, 30, 31], "can": [1, 9, 12, 28, 29, 30, 31], "t": [1, 9, 12, 29, 30, 31], "pleas": [1, 9, 31], "consid": [1, 9, 30, 31], "small": [1, 9, 30, 31], "valu": [1, 7, 9, 29, 30, 31], "should": [1, 7, 9, 12, 29, 30, 31], "posit": [1, 9], "within": [1, 9], "5": [1, 9, 12, 29, 30], "smaller": [1, 9, 29, 30, 31], "than": [1, 9, 29, 30, 31], "larger": [1, 9, 31], "equal": [1, 9, 29], "10": [1, 9, 29, 30, 31], "select": [1, 9, 31], "phase": [1, 9], "either": [1, 9, 28, 29, 31], "__repr__": [1, 9], "return": [1, 3, 7, 9, 12], "repr": [1, 9], "self": [1, 9, 24], "type": [1, 3, 7, 9, 12, 24, 30], "_couple_model_and_sourc": [1, 9], "_flattening_func": [1, 9], "_insert_intf": [1, 9], "flatten": [1, 9, 30, 31], "use_kappa": [1, 9, 30], "r_planet": [1, 9], "store": [1, 9, 30], "numpi": [1, 3, 5, 6, 9, 28, 29, 30, 31], "2d": [1, 7, 9, 30], "arrai": [1, 9, 30], "inform": [1, 9, 29, 30, 31], "1d": [1, 9, 28, 30], "same": [1, 7, 9, 12, 30, 31], "format": [1, 9, 28, 30], "fk": [1, 7, 9, 12, 28, 30, 31], "ha": [1, 7, 9, 28, 29, 30, 31], "follow": [1, 9, 29, 30], "unit": [1, 9, 28, 30], "g": [1, 9], "cm3": [1, 9], "each": [1, 7, 9, 30], "column": [1, 9, 30], "thick": [1, 6, 9, 30], "v": [1, 6, 9, 29], "vp_or_vp": [1, 9], "rho": [1, 9, 30], "q": [1, 6, 9], "qp": [1, 6, 9], "77": [1, 9], "32": [1, 9], "vp": [1, 6, 9], "4th": [1, 9], "i": [1, 7, 9, 28, 29, 30, 31], "20": [1, 9, 30, 31], "treat": [1, 9], "500": [1, 9], "thei": [1, 9, 30], "ar": [1, 9, 28, 29, 30, 31], "specifi": [1, 9, 30], "If": [1, 9, 29, 30, 31], "layer": [1, 7, 9, 30], "repres": [1, 7, 9, 12, 30], "top": [1, 7, 9, 30], "elast": [1, 9], "half": [1, 7, 9, 30], "space": [1, 9], "otherwis": [1, 7, 9], "assum": [1, 9, 31], "vacuum": [1, 9], "doe": [1, 9], "need": [1, 9, 29, 30], "last": [1, 9], "e": [1, 9, 30], "bottom": [1, 7, 9], "anywai": [1, 9, 30], "third": [1, 9], "file": [1, 9, 30], "ratio": [1, 9, 30], "defin": [1, 9, 30], "least": [1, 9], "three": [1, 9, 12, 28, 29, 30], "integ": [1, 9], "__copy__": [1, 9], "copi": [1, 9, 28, 30], "current": [1, 9, 28, 29, 31], "influenc": [1, 9, 30], "add_lay": [1, 9], "dd": [1, 9], "idep": [1, 9], "insert": [1, 9], "so": [1, 9, 28, 29, 30, 31], "locat": [1, 7, 9, 30], "interfac": [1, 9], "later": [1, 9, 29], "where": [1, 7, 9], "most": [1, 9, 30, 31], "index": [1, 9], "properti": [1, 9], "get": [1, 9, 30, 31], "statu": [1, 9], "attenu": [1, 9, 30], "remove_topo": [1, 9], "when": [1, 9, 29, 30, 31], "rh": [1, 9], "densiti": [1, 9, 30], "th": [1, 9], "sdep": [1, 9, 30, 31], "srctype": [1, 9, 30], "dc": [1, 9, 30], "source_mechan": [1, 9, 30], "about": [1, 9, 30, 31], "ep": [1, 9], "explos": [1, 9, 28], "sf": [1, 9], "singl": [1, 3, 9, 28, 29], "forc": [1, 3, 9, 28], "doubl": [1, 3, 9, 28, 30], "coupl": [1, 3, 9, 28, 30], "length": [1, 9, 30], "4": [1, 9, 30], "7": [1, 9, 29, 30], "order": [1, 3, 7, 9, 12, 30], "event": [1, 9, 30], "obspi": [1, 9, 12, 28, 29, 30, 31], "read": [1, 9, 12, 30, 31], "cmt": [1, 9, 30], "solut": [1, 9, 30], "read_ev": [1, 9, 30], "descript": [1, 9, 12], "_update_source_mechan": [1, 9], "intern": [1, 9], "updat": [1, 9], "mechan": [1, 9, 30], "correct": [1, 9], "calculate_radiation_pattern": [1, 9], "az": [1, 3, 9, 12], "pattern": [1, 3, 9, 12], "station": [1, 9, 12, 30], "azimuth": [1, 3, 9, 12, 30], "measur": [1, 9, 12], "from": [1, 3, 9, 12, 29, 30, 31], "north": [1, 9, 12], "clockwis": [1, 7, 9, 12], "m0": [1, 9], "associ": [1, 9], "magnitud": [1, 9], "nn": [1, 9], "rad": [1, 9], "update_source_mechan": [1, 9, 30], "after": [1, 9, 29, 30, 31], "creation": [1, 9], "couldn": [1, 9], "dc_radiat": 3, "stk": 3, "dip": 3, "rak": 3, "strike": 3, "rake": 3, "matrix": [3, 7], "mt_radiat": 3, "m": [3, 30], "moment": [3, 30], "tensor": 3, "x": [3, 5], "y": 3, "z": [3, 9, 12, 30], "ned": 3, "coordin": 3, "alreadi": [3, 30], "convert": [3, 30], "rtp": 3, "param": 3, "angl": [3, 30], "mean": [3, 30, 31], "symmetr": 3, "rtype": 3, "sf_radiat": 3, "cujn": 5, "cal_cujn": 5, "n": 5, "compoundmatrix": 5, "ccc": 5, "ca": 5, "ya": 5, "xa": 5, "cb": 5, "yb": 5, "xb": 5, "exa": 5, "exb": 5, "r": [5, 9, 12, 30], "r1": 5, "mu2": 5, "evector": 5, "eee": 5, "ra": 5, "rb": 5, "haskellmatrix": 5, "aaa": 5, "initialg": 5, "ggg": 5, "initialz": 5, "zzz": 5, "sss": 5, "propagateb": 5, "bbb": 5, "propagateg": 5, "propagatez": 5, "separat": 5, "src_type": [5, 6, 7], "temppp": 5, "si": [5, 6, 7], "sh_ch": 5, "kd": 5, "_waveform_integr": 6, "nfft2": [6, 7], "dw": [6, 7], "kc": [6, 7], "wc1": [6, 7], "flip": [6, 7], "filter_const": [6, 7], "dynam": [6, 7], "wc2": [6, 7], "t0": [6, 7], "wc": [6, 7], "mu": 6, "src_layer": [6, 7], "rcv_layer": [6, 7], "epsilon": [6, 10], "sigma": [6, 7, 10], "sum_waveform": 6, "cuda_divide_num": [6, 31], "apply_filt": 6, "fill_val": 6, "n_list": 6, "n_list_accumul": 6, "ik_list": 6, "i_list": 6, "current_n_al": 6, "current_offset": 6, "get_n_list_kpk": 6, "kp_list": 6, "ks_list": 6, "get_sum_waveform": 6, "u": [6, 30], "flip_val": 6, "z_list": 6, "aj0_list": 6, "aj1_list": 6, "aj2_list": 6, "get_z_list": 6, "parallel_kernel": 6, "calculate_gf": [7, 9, 12, 30, 31], "comput": [7, 9, 12, 28, 29], "displac": [7, 9, 12, 28, 30], "cm": [7, 9, 12, 30], "radial": [7, 9, 12], "outward": [7, 9, 12], "transvers": [7, 9, 12], "direct": [7, 9, 12], "produc": [7, 9, 12], "differ": [7, 9, 12, 30], "seismic": [7, 9, 12, 28], "row": [7, 9, 30], "static": [7, 9, 17, 21, 23, 28, 30], "stream": [7, 9, 12, 30], "keep": [7, 9], "calculate_gf_sourc": 7, "propog": 7, "oper": 7, "flipe": 7, "waveform_integr": 7, "main": [7, 28, 31], "wrap": 7, "cython": [7, 28, 29, 31], "do": [7, 28, 30], "integr": [7, 28, 30, 31], "simul": [7, 30, 31], "been": [7, 28, 29, 30, 31], "const": 7, "perform": [7, 28, 30, 31], "start": [7, 30, 31], "end": [7, 30], "beyond": 7, "which": [7, 28, 29, 30, 31], "take": 7, "effect": 7, "time": [7, 9, 12, 28, 29, 30, 31], "supress": 7, "result": [7, 30, 31], "calculate_sync": [9, 12, 30], "source_time_funct": [9, 12, 30], "just": [9, 12, 29, 30], "an": [9, 12, 30], "one": [9, 12, 30, 31], "databas": [9, 12], "trace": [9, 12, 30], "data": [9, 12, 28, 30, 31], "generate_source_time_funct": [9, 12, 30], "trapezoid": [9, 12, 30], "shape": [9, 12, 30], "check": [9, 12, 29], "input": [9, 12], "delta": [9, 12, 30], "compon": [9, 12, 30], "dura": [9, 12, 30], "rise": [9, 12, 30], "summari": [9, 12], "0001": 10, "r_earth": 10, "sync_calculate_gf": 12, "stack": 12, "attach": [12, 30], "actual": [12, 31], "testclassconfig": 15, "test_model_6column": 15, "test__flatten": 15, "test_catch_except": 15, "test_catch_warn": 15, "test_free_surfac": 15, "test_init": 15, "test_radiation_pattern": 15, "test_topo": 15, "testclassseismodel": 15, "test_add_lay": 15, "test_copi": 15, "test_get_attribut": 15, "test_init_flattening_kappa_6column": 15, "test_init_flattening_nokappa_6column": 15, "test_init_noflattening_kappa_6column": 15, "test_init_noflattening_nokappa_3column": 15, "test_init_noflattening_nokappa_4column_abnorm": 15, "test_init_noflattening_nokappa_4column_norm": 15, "test_init_noflattening_nokappa_5column": 15, "test_init_noflattening_nokappa_6column": 15, "test_remove_topo": 15, "testclasssourcemodel": 15, "test_set_sdep": 15, "testfunctioncalculategf": 17, "test_big_arrai": 17, "test_filt": 17, "test_hk": 17, "test_prem_ep": 17, "test_prem_sf": 17, "test_receiver_deep": 17, "test_smth": 17, "test_static_sourc": 17, "testfunctioncalculategf_mpi": 18, "test_mpi_info": 18, "test_val_correct": 18, "testfunctioncalculatesync": [21, 30], "get_sample_gcmt_file_path": [21, 30], "test_except": 21, "test_prem": 21, "testfunctiontaup": [23, 30, 31], "gen_test_model": [23, 30, 31], "model_nam": 23, "test_earth_model": 23, "except": 24, "initi": [24, 28, 30], "see": [24, 30], "help": [24, 28], "accur": 24, "signatur": 24, "pyfkwarn": 24, "userwarn": 24, "python": [28, 29, 30, 31], "port": 28, "seismogram": 28, "packag": [28, 30, 31], "version": [28, 29, 31], "wa": 28, "develop": 28, "prof": 28, "lupei": 28, "zhu": 28, "1996": 28, "code": [28, 29, 30, 31], "written": 28, "fortran": 28, "c": [28, 29], "perl": 28, "nowadai": 28, "usual": [28, 29], "more": [28, 30, 31], "effici": [28, 31], "seismolog": 28, "research": 28, "workflow": 28, "wide": 28, "scipi": [28, 29], "also": [28, 29, 30, 31], "easi": 28, "parallel": [28, 29], "cpu": 28, "gpu": 28, "improv": 28, "speed": [28, 30], "featur": [28, 29], "method": 28, "correspond": [28, 30], "convolv": [28, 30, 31], "signal": 28, "process": [28, 29, 30, 31], "And": [28, 30], "uniqu": 28, "pure": 28, "compat": [28, 29], "unix": [28, 29], "like": [28, 29], "system": [28, 29, 31], "includ": [28, 29, 30, 31], "mac": [28, 29], "linux": [28, 29], "window": [28, 29], "support": [28, 29, 31], "complex": [28, 29], "c99": [28, 29], "standard": [28, 29], "visual": 28, "studio": 28, "compil": [28, 29, 31], "computation": 28, "expens": 28, "part": [28, 30, 31], "mainli": [28, 30], "serial": [28, 29, 31], "implement": 28, "algorithm": [28, 30, 31], "mpi": [28, 30], "simpli": [28, 30], "pip": [28, 29, 31], "Or": [28, 29], "conda": [28, 29, 31], "ziyixi": [28, 29], "It": [28, 29, 30, 31], "enabl": [28, 29, 31], "pyfk_use_mpi": [28, 29, 31], "extra": [28, 29], "numba": [28, 29, 31], "cupi": [28, 29, 31], "requir": [28, 29, 30, 31], "For": [28, 29, 30, 31], "detail": [28, 30], "you": [28, 29, 30, 31], "refer": [28, 29, 30], "bug": 28, "fix": 28, "free": [28, 31], "softwar": 28, "redistribut": 28, "modifi": 28, "under": 28, "apach": 28, "A": [28, 30, 31], "my": 28, "undergradu": 28, "thesi": 28, "project": 28, "ustc": 28, "would": 28, "thank": 28, "daoyuan": 28, "sun": 28, "mentor": 28, "me": 28, "ph": 28, "d": 28, "advisor": 28, "chen": 28, "songqiao": 28, "shawn": 28, "wei": 28, "studi": 28, "state": 28, "have": [28, 29, 30, 31], "energi": 28, "finish": [28, 30, 31], "8": [29, 30], "9": [29, 30], "prior": 29, "6": [29, 30], "issu": 29, "doesn": [29, 31], "other": [29, 30], "platform": 29, "o": [29, 30], "m1": 29, "chip": 29, "might": [29, 30, 31], "through": 29, "pypi": 29, "To": [29, 30, 31], "note": [29, 30, 31], "command": 29, "fail": 29, "some": [29, 30], "rare": 29, "case": [29, 30], "mpi4pi": [29, 31], "local": [29, 31], "mai": [29, 31], "openmpi": 29, "mpich": 29, "try": [29, 31], "poetri": 29, "core": [29, 30], "http": 29, "github": 29, "com": 29, "archiv": 29, "ref": 29, "tag": 29, "0a7": 29, "zip": 29, "ani": [29, 31], "releas": 29, "cysign": 29, "build": 29, "isol": 29, "anaconda": 29, "environ": [29, 31], "variabl": [29, 31], "fulli": 29, "replac": 29, "normal": 29, "run": [29, 30, 31], "mpirun": [29, 31], "work": 29, "depend": [29, 31], "especi": 29, "super": 29, "advis": 29, "reinstal": 29, "uninstal": 29, "attempt": 29, "its": [29, 31], "own": 29, "fine": 29, "node": 29, "But": [29, 30], "conflict": 29, "srun": 29, "ibrun": 29, "without": [29, 30], "cach": 29, "wheel": 29, "dir": 29, "apart": 29, "suggest": [29, 31], "download": 29, "better": [29, 31], "incorpor": 29, "toolkit": 29, "forg": 29, "special": [29, 31], "driver": 29, "nvidia": [29, 31], "smi": [29, 31], "As": [29, 30, 31], "cudatoolkit": 29, "higher": 29, "risk": 29, "runtim": 29, "error": 29, "exampl": [29, 30, 31], "cluster": [29, 31], "msu": 29, "icer": 29, "11": 29, "while": [29, 31], "abov": 29, "april": 29, "2022": 29, "we": [29, 30, 31], "two": [29, 30, 31], "possibl": [29, 30, 31], "These": 29, "There": [29, 30, 31], "noth": 29, "import": [29, 30, 31], "mpi_info": 29, "output": [29, 30], "relat": 29, "complet": 29, "sever": [29, 30], "pytest": 29, "pyarg": 29, "warn": 29, "omit": 29, "divid": [29, 30, 31], "cross": 29, "correl": 29, "mpu": 29, "paral": 29, "In": [30, 31], "introduc": [30, 31], "primari": 30, "usag": 30, "instanc": 30, "class": 30, "epicent": 30, "upper": 30, "level": [30, 31], "directli": [30, 31], "them": 30, "earthquak": 30, "discuss": 30, "howev": [30, 31], "source_prem": 30, "16": 30, "print": 30, "whose": 30, "5km": 30, "veloc": 30, "v_": 30, "p": 30, "v_p": 30, "q_": 30, "q_p": 30, "prepar": 30, "loadtxt": 30, "load": [30, 31], "representsa": 30, "similar": 30, "less": 30, "here": 30, "prem": [30, 31], "path": 30, "dirnam": 30, "join": 30, "prem_data": 30, "600": 30, "1456": 30, "1350": 30, "49094": 30, "11061": 30, "38076": 30, "1446": 30, "48486": 30, "10119": 30, "37906": 30, "47715": 30, "08907": 30, "37688": 30, "1447": 30, "model_prem": 30, "44": 30, "control": 30, "describ": 30, "keyword": 30, "initil": 30, "frac": 30, "keywork": 30, "By": 30, "now": 30, "speak": 30, "wai": [30, 31], "config_prem": 30, "512": [30, 31], "arang": 30, "40": 30, "45": 30, "30": [30, 31], "previous": 30, "our": [30, 31], "10km": 30, "20km": 30, "30km": 30, "plan": 30, "true": [30, 31], "automat": [30, 31], "One": 30, "thing": 30, "deep": 30, "reus": 30, "futur": [30, 31], "wonder": 30, "share": 30, "call": [30, 31], "0x7f65a404be20": 30, "0x7f65a70fed90": 30, "0x7f656aef5940": 30, "consist": [30, 31], "introduct": [30, 31], "seisman": [30, 31], "chines": [30, 31], "header": 30, "stat": 30, "network": 30, "channel": 30, "starttim": 30, "1969": 30, "12": 30, "31t23": 30, "59": 30, "58": 30, "280712z": 30, "endtim": 30, "1970": 30, "01": 30, "01t00": 30, "00": 30, "49": 30, "380712z": 30, "sampling_r": 30, "calib": 30, "sac": 30, "attribdict": 30, "b": 30, "71928822781415": 30, "480711772185856": 30, "dist": 30, "t1": 30, "28071177218585": 30, "t2": 30, "927151680565519": 30, "user1": 30, "143": 30, "31697531118135": 30, "user2": 30, "141": 30, "8427788468466": 30, "origin": 30, "00000z": 30, "subtract": 30, "alread": 30, "emiss": 30, "config_prem_stat": 30, "gf_static": 30, "82673702e": 30, "05": 30, "17737927e": 30, "00000000e": 30, "15497936e": 30, "98594656e": 30, "06": 30, "35277715e": 30, "14703318e": 30, "09000029e": 30, "47091370e": 30, "07": 30, "1000": 30, "user": 30, "view": 30, "plot": 30, "figur": 30, "size": 30, "800x250": 30, "ax": 30, "attribut": 30, "rate": 30, "ident": 30, "seri": 30, "syn": 30, "conveni": 30, "global": 30, "test_gcmt_path": 30, "open": 30, "f": 30, "line": 30, "mli": 30, "1976": 30, "29": 30, "39": 30, "60": 30, "28": 30, "6100": 30, "177": 30, "6400": 30, "kermadec": 30, "island": 30, "region": 30, "name": [30, 31], "010176a": 30, "shift": 30, "13": 30, "8000": 30, "durat": 30, "4000": 30, "latitud": 30, "2500": 30, "longitud": 30, "176": 30, "9600": 30, "5000": 30, "mrr": 30, "680000e": 30, "26": 30, "mtt": 30, "000000e": 30, "24": 30, "mpp": 30, "770000e": 30, "mrt": 30, "390000e": 30, "mrp": 30, "520000e": 30, "mtp": 30, "260000e": 30, "someth": 30, "notic": 30, "content": 30, "prem_model": 30, "sync_result": 30, "strang": 30, "amplitud": 30, "around": 30, "hundr": 30, "lot": 30, "kind": 30, "reason": [30, 31], "largest": 30, "rel": 30, "thu": 30, "bound": 30, "remind": 30, "even": 30, "want": 30, "advic": 30, "stabliz": 30, "simulat": 30, "differenti": 30, "band": 30, "highest": 30, "nyquist": 30, "5hz": 30, "bandpass": 30, "3hz": 30, "sync_result_to_filt": 30, "detrend": 30, "linear": 30, "max_percentag": 30, "hann": 30, "freqmin": 30, "freqmax": 30, "corner": 30, "zerophas": 30, "stage": 30, "side": 30, "congratul": 30, "api": 30, "close": 30, "enough": [30, 31], "due": 30, "program": 30, "languag": 30, "how": 30, "why": 31, "think": 31, "toler": 31, "ineffici": 31, "much": 31, "faster": 31, "idea": 31, "simpl": 31, "know": 31, "loop": 31, "anoth": 31, "larg": 31, "design": 31, "consum": 31, "reli": 31, "everyth": 31, "machin": 31, "mention": 31, "insid": 31, "successfulli": 31, "instal": 31, "script": 31, "model_data": 31, "detect": 31, "broadcast": 31, "further": 31, "rank": 31, "talk": 31, "dure": 31, "relationship": 31, "addit": 31, "avoid": 31, "unnecessari": 31, "kernel": 31, "remov": 31, "don": 31, "modif": 31, "exist": 31, "long": 31, "benchmark": 31, "migrat": 31, "job": 31, "worthi": 31, "problem": 31, "memori": 31, "big": 31, "move": 31, "info": 31, "workaround": 31, "subset": 31, "bottleneck": 31, "solv": 31, "thread": 31, "pretti": 31, "fast": 31, "surpris": 31, "look": 31, "monitor": 31, "although": 31, "multipl": 31, "find": 31, "alloc": 31, "your": 31, "put": 31, "select_devic": 31, "sinc": 31, "jit": 31, "slower": 31, "awar": 31}, "objects": {"": [[9, 0, 0, "-", "pyfk"]], "pyfk": [[9, 1, 1, "", "Config"], [9, 1, 1, "", "SeisModel"], [9, 1, 1, "", "SourceModel"], [9, 3, 1, "", "calculate_gf"], [9, 3, 1, "", "calculate_sync"], [2, 0, 0, "-", "config"], [9, 3, 1, "", "generate_source_time_function"], [8, 0, 0, "-", "gf"], [10, 0, 0, "-", "setting"], [11, 0, 0, "-", "sync"], [13, 0, 0, "-", "taup"], [19, 0, 0, "-", "tests"], [25, 0, 0, "-", "utils"]], "pyfk.Config": [[9, 2, 1, "", "__repr__"], [9, 2, 1, "", "_couple_model_and_source"], [9, 2, 1, "", "_flattening_func"], [9, 2, 1, "", "_insert_intf"]], "pyfk.SeisModel": [[9, 2, 1, "", "__copy__"], [9, 2, 1, "", "__repr__"], [9, 2, 1, "", "add_layer"], [9, 2, 1, "", "flattening"], [9, 2, 1, "", "qp"], [9, 2, 1, "", "qs"], [9, 2, 1, "", "remove_topo"], [9, 2, 1, "", "rh"], [9, 2, 1, "", "th"], [9, 2, 1, "", "vp"], [9, 2, 1, "", "vs"]], "pyfk.SourceModel": [[9, 2, 1, "", "__repr__"], [9, 2, 1, "", "_update_source_mechanism"], [9, 2, 1, "", "calculate_radiation_pattern"], [9, 2, 1, "", "m0"], [9, 2, 1, "", "nn"], [9, 2, 1, "", "rad"], [9, 2, 1, "", "sdep"], [9, 2, 1, "", "srcType"], [9, 2, 1, "", "update_source_mechanism"]], "pyfk.config": [[1, 0, 0, "-", "config"], [3, 0, 0, "-", "radiats"]], "pyfk.config.config": [[1, 1, 1, "", "Config"], [1, 1, 1, "", "SeisModel"], [1, 1, 1, "", "SourceModel"]], "pyfk.config.config.Config": [[1, 2, 1, "", "__repr__"], [1, 2, 1, "", "_couple_model_and_source"], [1, 2, 1, "", "_flattening_func"], [1, 2, 1, "", "_insert_intf"]], "pyfk.config.config.SeisModel": [[1, 2, 1, "", "__copy__"], [1, 2, 1, "", "__repr__"], [1, 2, 1, "", "add_layer"], [1, 2, 1, "", "flattening"], [1, 2, 1, "", "qp"], [1, 2, 1, "", "qs"], [1, 2, 1, "", "remove_topo"], [1, 2, 1, "", "rh"], [1, 2, 1, "", "th"], [1, 2, 1, "", "vp"], [1, 2, 1, "", "vs"]], "pyfk.config.config.SourceModel": [[1, 2, 1, "", "__repr__"], [1, 2, 1, "", "_update_source_mechanism"], [1, 2, 1, "", "calculate_radiation_pattern"], [1, 2, 1, "", "m0"], [1, 2, 1, "", "nn"], [1, 2, 1, "", "rad"], [1, 2, 1, "", "sdep"], [1, 2, 1, "", "srcType"], [1, 2, 1, "", "update_source_mechanism"]], "pyfk.config.radiats": [[3, 3, 1, "", "dc_radiat"], [3, 3, 1, "", "mt_radiat"], [3, 3, 1, "", "sf_radiat"]], "pyfk.gf": [[4, 0, 0, "-", "cuda"], [7, 0, 0, "-", "gf"]], "pyfk.gf.cuda": [[5, 0, 0, "-", "utils"], [6, 0, 0, "-", "waveform_integration_cuda"]], "pyfk.gf.cuda.utils": [[5, 3, 1, "", "cal_cujn"], [5, 3, 1, "", "compoundMatrix"], [5, 4, 1, "", "cujn"], [5, 3, 1, "", "eVector"], [5, 3, 1, "", "haskellMatrix"], [5, 3, 1, "", "initialG"], [5, 3, 1, "", "initialZ"], [5, 3, 1, "", "propagateB"], [5, 3, 1, "", "propagateG"], [5, 3, 1, "", "propagateZ"], [5, 3, 1, "", "separatS"], [5, 3, 1, "", "sh_ch"]], "pyfk.gf.cuda.waveform_integration_cuda": [[6, 3, 1, "", "_waveform_integration"], [6, 3, 1, "", "apply_filter"], [6, 3, 1, "", "fill_vals"], [6, 3, 1, "", "get_n_list_kpks"], [6, 3, 1, "", "get_sum_waveform"], [6, 3, 1, "", "get_z_list"], [6, 3, 1, "", "parallel_kernel"]], "pyfk.gf.gf": [[7, 3, 1, "", "calculate_gf"], [7, 3, 1, "", "calculate_gf_source"], [7, 3, 1, "", "waveform_integration"]], "pyfk.setting": [[10, 4, 1, "", "EPSILON"], [10, 4, 1, "", "R_EARTH"], [10, 4, 1, "", "SIGMA"]], "pyfk.sync": [[12, 0, 0, "-", "sync"]], "pyfk.sync.sync": [[12, 3, 1, "", "calculate_sync"], [12, 3, 1, "", "generate_source_time_function"], [12, 3, 1, "", "sync_calculate_gf"]], "pyfk.tests": [[14, 0, 0, "-", "config"], [16, 0, 0, "-", "gf"], [20, 0, 0, "-", "sync"], [22, 0, 0, "-", "taup"]], "pyfk.tests.config": [[15, 0, 0, "-", "test_config"]], "pyfk.tests.config.test_config": [[15, 1, 1, "", "TestClassConfig"], [15, 1, 1, "", "TestClassSeisModel"], [15, 1, 1, "", "TestClassSourceModel"]], "pyfk.tests.config.test_config.TestClassConfig": [[15, 2, 1, "", "test__flattening"], [15, 2, 1, "", "test_catch_exceptions"], [15, 2, 1, "", "test_catch_warning"], [15, 2, 1, "", "test_free_surface"], [15, 2, 1, "", "test_init"], [15, 5, 1, "", "test_model_6column"], [15, 2, 1, "", "test_radiation_pattern"], [15, 2, 1, "", "test_topo"]], "pyfk.tests.config.test_config.TestClassSeisModel": [[15, 2, 1, "", "test_add_layer"], [15, 2, 1, "", "test_catch_exceptions"], [15, 2, 1, "", "test_copy"], [15, 2, 1, "", "test_get_attribute"], [15, 2, 1, "", "test_init_flattening_kappa_6column"], [15, 2, 1, "", "test_init_flattening_nokappa_6column"], [15, 2, 1, "", "test_init_noflattening_kappa_6column"], [15, 2, 1, "", "test_init_noflattening_nokappa_3column"], [15, 2, 1, "", "test_init_noflattening_nokappa_4column_abnormal"], [15, 2, 1, "", "test_init_noflattening_nokappa_4column_normal"], [15, 2, 1, "", "test_init_noflattening_nokappa_5column"], [15, 2, 1, "", "test_init_noflattening_nokappa_6column"], [15, 5, 1, "", "test_model_6column"], [15, 2, 1, "", "test_remove_topo"]], "pyfk.tests.config.test_config.TestClassSourceModel": [[15, 2, 1, "", "test_catch_exceptions"], [15, 2, 1, "", "test_init"], [15, 2, 1, "", "test_set_sdep"]], "pyfk.tests.gf": [[17, 0, 0, "-", "test_gf"], [18, 0, 0, "-", "test_gf_mpi"]], "pyfk.tests.gf.test_gf": [[17, 1, 1, "", "TestFunctioncalculateGf"]], "pyfk.tests.gf.test_gf.TestFunctioncalculateGf": [[17, 2, 1, "", "test_big_array"], [17, 2, 1, "", "test_filter"], [17, 2, 1, "", "test_hk"], [17, 2, 1, "", "test_prem_ep"], [17, 2, 1, "", "test_prem_sf"], [17, 2, 1, "", "test_receiver_deeper"], [17, 2, 1, "", "test_smth"], [17, 2, 1, "", "test_static_source"]], "pyfk.tests.gf.test_gf_mpi": [[18, 1, 1, "", "TestFunctioncalculateGf_MPI"]], "pyfk.tests.gf.test_gf_mpi.TestFunctioncalculateGf_MPI": [[18, 2, 1, "", "test_mpi_info"], [18, 2, 1, "", "test_val_correct"]], "pyfk.tests.sync": [[21, 0, 0, "-", "test_sync"]], "pyfk.tests.sync.test_sync": [[21, 1, 1, "", "TestFunctionCalculateSync"]], "pyfk.tests.sync.test_sync.TestFunctionCalculateSync": [[21, 2, 1, "", "get_sample_gcmt_file_path"], [21, 2, 1, "", "test_exceptions"], [21, 2, 1, "", "test_prem"]], "pyfk.tests.taup": [[23, 0, 0, "-", "test_taup"]], "pyfk.tests.taup.test_taup": [[23, 1, 1, "", "TestFunctionTaup"]], "pyfk.tests.taup.test_taup.TestFunctionTaup": [[23, 2, 1, "", "gen_test_model"], [23, 2, 1, "", "test_earth_models"]], "pyfk.utils": [[24, 0, 0, "-", "error_message"]], "pyfk.utils.error_message": [[24, 6, 1, "", "PyfkError"], [24, 6, 1, "", "PyfkWarning"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:data", "5": "py:attribute", "6": "py:exception"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "data", "Python data"], "5": ["py", "attribute", "Python attribute"], "6": ["py", "exception", "Python exception"]}, "titleterms": {"api": 0, "refer": 0, "pyfk": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 29], "config": [1, 2, 3, 14, 15], "modul": [1, 3, 5, 6, 7, 10, 12, 15, 17, 18, 21, 23, 24], "content": [1, 3, 5, 6, 7, 9, 10, 12, 15, 17, 18, 21, 23, 24], "class": [1, 9, 15, 17, 18, 21, 23], "submodul": [2, 4, 8, 9, 11, 14, 16, 20, 22, 25], "radiat": 3, "function": [3, 5, 6, 7, 9, 12, 30], "gf": [4, 5, 6, 7, 8, 16, 17, 18], "cuda": [4, 5, 6], "util": [5, 24, 25], "attribut": 5, "waveform_integration_cuda": 6, "subpackag": [8, 9, 19], "packag": [9, 29], "set": 10, "sync": [11, 12, 20, 21], "taup": [13, 22, 23], "test": [14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29], "test_config": 15, "test_gf": 17, "test_gf_mpi": 18, "test_sync": 21, "test_taup": 23, "error_messag": 24, "benchmark": 26, "galleri": 27, "about": 28, "instal": [28, 29], "todo": 28, "licens": 28, "acknowledg": 28, "gener": [29, 30], "mpi": [29, 31], "mode": [29, 31], "gpu": [29, 31], "tutori": 30, "configur": 30, "calcul": 30, "green": 30, "": 30, "synthet": 30, "waveform": 30, "parallel": 31, "usag": 31, "tip": 31}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})